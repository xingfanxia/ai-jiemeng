@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* Enable class-based dark mode (Tailwind v4) */
@custom-variant dark (&:where(.dark, .dark *));

/* ================================================
   Theme Configuration (Tailwind v4)
   AI周公解梦 - Dream Interpretation Theme
   Deep purple/indigo night sky with mystical accents
   ================================================ */
@theme inline {
  /* Colors - shadcn/ui system */
  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));

  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));

  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));

  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));

  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));

  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));

  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));

  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));

  /* Fortune colors - semantic */
  --color-fortune-auspicious: hsl(var(--fortune-auspicious));
  --color-fortune-good: hsl(var(--fortune-good));
  --color-fortune-neutral: hsl(var(--fortune-neutral));
  --color-fortune-caution: hsl(var(--fortune-caution));
  --color-fortune-inauspicious: hsl(var(--fortune-inauspicious));

  /* Dream symbol colors */
  --color-dream-mystical: hsl(var(--dream-mystical));
  --color-dream-water: hsl(var(--dream-water));
  --color-dream-fire: hsl(var(--dream-fire));
  --color-dream-earth: hsl(var(--dream-earth));
  --color-dream-sky: hsl(var(--dream-sky));

  /* Border radius */
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);

  /* Shadows */
  --shadow-soft: 0 2px 8px -2px rgba(0, 0, 0, 0.08), 0 4px 16px -4px rgba(0, 0, 0, 0.04);
  --shadow-soft-lg: 0 4px 12px -4px rgba(0, 0, 0, 0.1), 0 8px 24px -8px rgba(0, 0, 0, 0.06);
  --shadow-dream: 0 4px 20px -4px rgba(99, 102, 241, 0.2), 0 8px 32px -8px rgba(139, 92, 246, 0.15);

  /* Animations */
  --animate-fade-in: fade-in 0.3s ease-out;
  --animate-slide-up: slide-up 0.3s ease-out;
  --animate-scale-in: scale-in 0.2s ease-out;
  --animate-pulse-glow: pulse-glow 2s ease-in-out infinite;
}

/* Keyframes */
@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slide-up {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes scale-in {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.3); }
  50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.5); }
}

/* ================================================
   CSS Variables (Light/Dark Mode)
   Dream Theme: Deep purple/indigo night sky
   ================================================ */
:root {
  /* 解梦配色 - 神秘紫色/靛蓝色调 */
  --background: 248 10% 98%;  /* Soft lavender white */
  --foreground: 240 10% 15%;  /* Deep slate */

  --card: 0 0% 100%;
  --card-foreground: 240 10% 15%;

  --popover: 0 0% 100%;
  --popover-foreground: 240 10% 15%;

  /* 主色调：深靛蓝/紫色 - Mystical indigo */
  --primary: 243 75% 59%;  /* Indigo #6366f1 */
  --primary-foreground: 0 0% 100%;

  /* 次要色：月光银/淡紫 - Moon silver */
  --secondary: 240 5% 92%;
  --secondary-foreground: 240 10% 30%;

  --muted: 240 5% 96%;
  --muted-foreground: 240 5% 45%;

  /* 点缀色：神秘金/琥珀 - Mystical gold accent */
  --accent: 38 92% 50%;  /* Gold #f59e0b */
  --accent-foreground: 0 0% 100%;

  --destructive: 0 72% 51%;
  --destructive-foreground: 0 0% 100%;

  --border: 240 6% 90%;
  --input: 240 6% 90%;
  --ring: 243 75% 59%;

  --radius: 0.75rem;

  /* 语义化颜色 - Fortune/吉凶 colors */
  --fortune-auspicious: 142 70% 45%;  /* 大吉 - Bright green */
  --fortune-good: 38 92% 50%;         /* 吉 - Gold */
  --fortune-neutral: 240 5% 50%;      /* 中平 - Gray */
  --fortune-caution: 25 95% 53%;      /* 凶 - Orange */
  --fortune-inauspicious: 0 72% 51%;  /* 大凶 - Red */

  /* 梦象颜色 - Dream symbol colors */
  --dream-mystical: 271 81% 56%;  /* Purple - 神秘 */
  --dream-water: 200 80% 50%;     /* Blue - 水/潜意识 */
  --dream-fire: 0 72% 51%;        /* Red - 火/情感 */
  --dream-earth: 35 65% 45%;      /* Brown - 土/稳定 */
  --dream-sky: 199 89% 48%;       /* Sky blue - 天空/自由 */
}

.dark {
  /* 解梦配色 - 暗色模式：深夜星空 */
  --background: 240 10% 6%;   /* Deep night blue-black */
  --foreground: 240 5% 96%;   /* Soft white */

  --card: 240 10% 10%;
  --card-foreground: 240 5% 96%;

  --popover: 240 10% 10%;
  --popover-foreground: 240 5% 96%;

  /* 主色调：亮靛蓝 - Brighter indigo for dark mode */
  --primary: 243 75% 70%;
  --primary-foreground: 240 10% 6%;

  /* 次要色：深灰紫 */
  --secondary: 240 10% 18%;
  --secondary-foreground: 240 5% 85%;

  --muted: 240 10% 18%;
  --muted-foreground: 240 5% 65%;

  /* 点缀色：暖金 */
  --accent: 38 92% 55%;
  --accent-foreground: 240 10% 6%;

  --destructive: 0 62% 55%;
  --destructive-foreground: 0 0% 100%;

  --border: 240 10% 18%;
  --input: 240 10% 18%;
  --ring: 243 75% 65%;

  /* 语义化颜色 - 暗色版 */
  --fortune-auspicious: 142 60% 55%;
  --fortune-good: 38 85% 55%;
  --fortune-neutral: 240 5% 55%;
  --fortune-caution: 25 90% 58%;
  --fortune-inauspicious: 0 62% 55%;

  /* 梦象颜色 - 暗色版 */
  --dream-mystical: 271 70% 65%;
  --dream-water: 200 70% 55%;
  --dream-fire: 0 62% 58%;
  --dream-earth: 35 55% 50%;
  --dream-sky: 199 80% 55%;
}

/* ================================================
   Base Styles
   ================================================ */
* {
  @apply border-border;
}

body {
  @apply bg-background text-foreground antialiased;
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* ================================================
   Custom Utilities
   ================================================ */

/* Traditional Chinese serif font */
.font-serif-cn {
  font-family: "Noto Serif SC", "Songti SC", "STSong", Georgia, serif;
}

/* Mobile scroll optimization */
.scroll-smooth {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* Hide scrollbar but keep functionality */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Touch feedback */
.touch-feedback {
  @apply active:scale-[0.98] active:opacity-90 transition-transform duration-100;
}

/* Safe area inset for mobile */
.safe-area-inset {
  padding-bottom: env(safe-area-inset-bottom);
}

/* ================================================
   Dream Theme Gradients
   ================================================ */

/* Mystical purple gradient */
.dream-gradient {
  background: linear-gradient(135deg,
    hsl(243 75% 59%) 0%,
    hsl(271 81% 56%) 50%,
    hsl(280 87% 65%) 100%
  );
}

.dream-gradient-subtle {
  background: linear-gradient(135deg,
    rgba(99, 102, 241, 0.1) 0%,
    rgba(139, 92, 246, 0.1) 50%,
    rgba(168, 85, 247, 0.1) 100%
  );
}

/* Night sky background */
.night-sky {
  background: linear-gradient(180deg,
    hsl(240 10% 6%) 0%,
    hsl(240 10% 12%) 50%,
    hsl(240 10% 18%) 100%
  );
}

/* Starfield effect for dark mode */
.dark .starfield {
  position: relative;
}
.dark .starfield::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image:
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.8), transparent),
    radial-gradient(2px 2px at 40% 70%, rgba(255,255,255,0.6), transparent),
    radial-gradient(1px 1px at 60% 20%, rgba(255,255,255,0.7), transparent),
    radial-gradient(1px 1px at 80% 50%, rgba(255,255,255,0.5), transparent),
    radial-gradient(1px 1px at 10% 80%, rgba(255,255,255,0.6), transparent),
    radial-gradient(2px 2px at 70% 90%, rgba(255,255,255,0.7), transparent);
  opacity: 0.4;
  pointer-events: none;
}

/* ================================================
   Fortune Indicator Styles
   ================================================ */

.fortune-auspicious {
  @apply text-green-600 dark:text-green-400;
}

.fortune-good {
  @apply text-amber-500 dark:text-amber-400;
}

.fortune-neutral {
  @apply text-gray-500 dark:text-gray-400;
}

.fortune-caution {
  @apply text-orange-500 dark:text-orange-400;
}

.fortune-inauspicious {
  @apply text-red-500 dark:text-red-400;
}

/* Fortune badges */
.fortune-badge-auspicious {
  @apply bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300;
}

.fortune-badge-good {
  @apply bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-300;
}

.fortune-badge-neutral {
  @apply bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300;
}

.fortune-badge-caution {
  @apply bg-orange-100 text-orange-700 dark:bg-orange-900/50 dark:text-orange-300;
}

.fortune-badge-inauspicious {
  @apply bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300;
}

/* ================================================
   Dream Symbol Card
   ================================================ */

.symbol-card {
  @apply relative overflow-hidden rounded-xl p-4;
  background: linear-gradient(
    to bottom,
    hsl(240 5% 99%) 0%,
    hsl(240 5% 97%) 100%
  );
  border: 1px solid hsl(240 6% 90%);
  box-shadow: var(--shadow-dream);
}

.dark .symbol-card {
  background: linear-gradient(
    to bottom,
    hsl(240 10% 12%) 0%,
    hsl(240 10% 10%) 100%
  );
  border-color: hsl(240 10% 20%);
}

/* ================================================
   Markdown & Content Styling
   ================================================ */

.markdown-text {
  color: hsl(var(--foreground));
}

.markdown-blockquote {
  border-left: 3px solid hsl(var(--primary));
  background-color: hsl(243 75% 97%);
  color: hsl(240 10% 30%);
  @apply pl-4 py-2 my-2 rounded-r;
}
.dark .markdown-blockquote {
  background-color: hsl(243 30% 15%);
  color: hsl(240 5% 80%);
}

.markdown-code {
  background-color: hsl(var(--secondary));
  color: hsl(var(--primary));
  @apply px-1.5 py-0.5 rounded text-sm font-mono;
}

/* ================================================
   Theme Transition
   ================================================ */

html.theme-transition,
html.theme-transition *,
html.theme-transition *::before,
html.theme-transition *::after {
  transition: background-color 0.3s ease,
              color 0.3s ease,
              border-color 0.3s ease,
              box-shadow 0.3s ease !important;
}

/* ================================================
   Input Mobile Optimization
   ================================================ */

input, textarea, select {
  font-size: 16px !important; /* Prevent iOS zoom */
}

/* ================================================
   Export/Share Utilities
   ================================================ */

/* Elements hidden during image export */
.export-hide {
  /* Marker class - visibility controlled via JS during export */
}

/* Watermark - hidden by default, shown during export */
.watermark {
  display: none;
}

.watermark.watermark-visible {
  display: block;
}
